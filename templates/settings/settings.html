<!doctype html>
<html lang="en" data-bs-theme="auto">
  <head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="Mark Otto, Jacob Thornton, and Bootstrap contributors">
    <meta name="generator" content="Hugo 0.122.0">
    <title>iBuzz2 - Settings</title>

    <link rel="canonical" href="https://getbootstrap.com/docs/5.3/examples/starter-template/">

    

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@docsearch/css@3">

<link href="templates\bootstrap.css" rel="stylesheet" crossorigin="anonymous">

<meta name="theme-color" content="#712cf9">
    
  </head>
  <body onload="setup()">

<div class="col-lg-8 mx-auto p-4 py-md-5">
  <header class="d-flex align-items-center pb-3 mb-5 border-bottom">
    <a href="/dashboard" class="d-flex align-items-center text-body-emphasis text-decoration-none">
      <svg class="bi me-2" width="40" height="32"><use xlink:href="#bootstrap"/></svg>
      <span class="fs-4">Settings</span>
    </a>
  </header>

  <h5>Notifications</h5>


  <form>
    <div class="mb-3">
      <label for="exampleSelect" class="form-label">Serial Number</label>
      <select class="form-select" id="notification_serial_number">
      </select>
    </div>
    <div class="mb-3">
      <label for="exampleSelect" class="form-label">Hive Number</label>
      <select class="form-select" id="notification_hive_number">
        <option selected="selected" value="">Select serial_number first</option>
      </select>
    </div>
    <fieldset class="mb-3">
      <div class="form-check">
        <input type="radio" name="radios" class="form-check-input" id="notification_less_then">
        <label class="form-check-label" for="exampleRadio1">Less Than</label>
      </div>
      <div class="mb-3 form-check">
        <input type="radio" name="radios" class="form-check-input" id="notification_greater_than">
        <label class="form-check-label" for="exampleRadio2">Greater Than</label>
      </div>
    </fieldset>
    <div class="mb-3">
      <label for="exampleInputEmail1" class="form-label">Threshold Value</label>
      <input type="number" step="0.1" class="form-control" id="notification_value">
    </div>
    <button type="submit" class="btn btn-primary">Submit</button>
  </form>


  <ul class="list-group" id="notification_list"></ul>
  
  <footer class="pt-5 my-5 text-body-secondary border-top">
    Template originally created by the Bootstrap team &middot; &copy; 2024
  </footer>
</div>
<script src="templates\bootstrap.js" crossorigin="anonymous"></script>
<script>

  function setup() {
    list_notifications()
    add_notification_serial_number_options()
  }

  function fetch_notifications() {
    return fetch('/notifications').then(r => r.json()).then(j => j['notifications'])
  }

  function delete_notification(notification_id) {
    fetch('/remove_notification/' + notification_id)
  }

  function notification_li(notification) {
    let li = document.createElement("li")
    li.setAttribute("class", "alert-dismissible fade show list-group-item")
    li.setAttribute("aria-disabled", "true")
    li.innerText = "Serial Number: " + notification[2] + ", Hive Number: " + notification[3] + ", " + notification[4] + " " + notification[5] + " " + notification[6]
    let button = document.createElement("button")
    button.setAttribute("type", "button")
    button.setAttribute("class", "btn-close")
    button.setAttribute("data-bs-dismiss", "alert")
    button.setAttribute("aria-label", "Close")
    let notification_id = notification[0]
    button.addEventListener("click", function() {
      li.setAttribute("class", li.getAttribute("class") + " disabled")
      delete_notification(notification_id)
    }, false)
    li.appendChild(button)
    return li
  }

  function no_notifications_li() {
    let li = document.createElement("li")
    li.setAttribute("class", "alert-dismissible fade show list-group-item")
    li.setAttribute("aria-disabled", "true")
    li.innerText = "You have no notifications. Create some above."
    return li
  }

  function list_notifications() {
    fetch_notifications().then(notifications => {
      let parent = document.getElementById("notification_list")
      if (notifications.length === 0) {
        let li = no_notifications_li()
        parent.appendChild(li)
      }
      else {
        notifications.forEach(notification => {
          console.log(notification)
          let li = notification_li(notification)
          parent.appendChild(li)
        });
      }
    })
  }


  function fetch_owned_serial_numbers() {
    return fetch('/owned_serial_numbers').then(r => r.json()).then(j => j['owned_serial_numbers'])
  }

  function add_notification_serial_number_options() {
    fetch_owned_serial_numbers().then(owned_serial_numbers => {
      let parent = document.getElementById("notification_serial_number")
      parent.onchange = function() {
        add_hive_number_options(this.value)
      }
      owned_serial_numbers.forEach(serial_number => {
        let option = document.createElement("option")
        option.setAttribute("value", serial_number[0])
        option.innerText = serial_number[0]
        parent.appendChild(option)
      });
    })
  }

  function fetch_hive_numbers(serial_number) {
    return fetch('/hive_numbers/' + serial_number).then(r => r.json()).then(j => j['hive_numbers'])
  }

  function add_hive_number_options(serial_number) {
    fetch_hive_numbers(serial_number).then(hive_numbers => {
      let parent = document.getElementById("notification_hive_number")
      parent.length = 1
      hive_numbers.forEach(hive_number => {
        let option = document.createElement("option")
        option.setAttribute("value", hive_number)
        option.innerText = hive_number
        parent.appendChild(option)
      });
    })
  }

</script>

    </body>
</html>
